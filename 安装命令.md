## 基本概念
程序不会凭空知道模组有没有安装以及要怎么进行安装卸载，这不是原力也不是魔法  
程序通过读取编写的安装命令才能判断模组有没有安装以及知道如何安装卸载

不过有部分人已经熟悉了第三代的命令名称，转第四代有些强人所难  
所以你可以继续在第四代中直接使用第三代的命令

## 书写格式
+ 命令是从上到下顺序执行的代码段，命令的参数紧跟着下一行
+ 所有命令都不区分大小写并且就算你多打了空格也可以正常识别
+ 但是参数不可以，因为参数是路径的一部分，所以不允许有任何字符错误
+ 不过从程序上讲，路径确实是不区分大小写的，但为了方便我们人去看还是不要乱大小写
+ 一个命令和另一个命令之间可以空行以帮助增加可读性
+ 但是命令与它的参数之间不允许空行，必须紧挨着下一行

## 文件
+ 安装命令保存于该项位置下的 Code 无后缀文本文件中
+ 这个文件名可以自定义，我可能会在更新中更改预设文件名
+ 使用 **UTF-8** 编码（BOM 不影响），必须使用 **CRLF** 换行符

---

## 动作类命令
动作类的命令为程序提供安装方法，程序可以根据这些命令计算出模组的各项信息  
前缀 CD 是单词 Command 的首尾字母

---

## CDCD（原 CDCP）
源自英文：Command Copy Directory (To Mods)

将文件夹复制到游戏文件夹的 Mods 文件夹  
所有的 SMAPI MOD 都使用此命令

### 新增功能
在第四代中，CDCD 支持套娃读取信息  
程序会自动扫描文件夹下所有的清单文件，并跳过不包含 Name 键的清单  
但是注意：对于判断是否已安装不能支持套娃，相当于只能判断那个文件夹在不在

### 格式
```
CDCD
[参数1：要复制的文件夹，从当前位置算起的相对路径]
```
### 举例
[Content Patcher](https://www.nexusmods.com/stardewvalley/mods/1915)
```
CDCD
ContentPatcher
```
[Stardew Valley Expanded 1.11](https://www.nexusmods.com/stardewvalley/mods/3753)
```
CDCD
[CP] Stardew Valley Expanded
CDCD
StardewValleyExpanded
CDCD
[CM] Stardew Valley Expanded
CDCD
[FTM] Stardew Valley Expanded
CDCD
[JA] Stardew Valley Expanded
CDCD
[TMX] Stardew Valley Expanded
```

像 SVE 这种有多个文件夹的，在第四代标准中建议使用一个单独的文件夹套起来  
也就是专门套娃，这有助于在 Mods 中进行手动管理  
但如果是从上一代直接过来的那就维持原状

后续补充：关于 SMAPI 的套娃支持很奇怪，有的时候套娃就能读取，有的时候就不行  
注意根据实际情况来决定是否要使用套娃

### 注意

每个项都类似于是一个模组的概念，请勿将其他非模组本身的文件夹和模组本身放在一个项里  
这会干扰前置读取，程序会自动检查前置项是否是此项本身的一员，并将匹配的项清除  
并且还会干扰程序集中的计算，从而引发各种自我迷惑行为  
比如出现无法读取到前置需求的情况

比如 SVE 作者老是喜欢把 [Custom NPC Fixes](https://www.nexusmods.com/stardewvalley/mods/3849) 和 [Custom Music](https://www.nexusmods.com/stardewvalley/mods/3043) 这两个其他人的模组与 SVE 放在一起发布  
切记不可将这些文件夹放入与 SVE 的同一个项中，否则程序不会将这两个模组作为前置输出

---

## CDGCD（原 CDCP-EXP）
源自英文：Command Global Copy Directory

将文件夹复制到游戏文件夹的任意位置

### 格式

```
CDGCD
[参数1：要复制的文件夹，从当前位置算起的相对路径]
[参数2：目标文件夹位置，从游戏目录算起的相对路径]
```

---

## CDMAD（原 CDAP）
源自英文：Command Mods Addition Directory

覆盖 Mods 中已存在的文件夹，程序会自动检查是否存在文件夹

### 格式

```
CDMAD
[参数1：要在 Mods 中覆盖的文件夹，从当前位置算起的相对路径]
```
---

## CDGRF（原 CDRF-SHA）
源自英文：Command Global Replace File

替换整个游戏的任意单个文件，并计算 SHA256 效验值来判断是否已安装  
如果文件较大，将会耗费较多时间来计算，可以考虑使用 CDF 命令（代价是没有安装判断）  
在此过程中可以另外实现重命名

### 格式
```
CDGRF
[参数1：要复制的文件，从当前位置算起的相对路径]
[参数2：目标文件位置，从游戏目录算起的相对路径]
```
### 注意
此命令设计用于覆盖游戏本身就有的文件  
当卸载时，程序会在[备份文件夹](备份文件夹.md)中找寻相同位置的文件  
如果找到则还原文件，反之则**删除目标文件！！！**

---

## CDGCF（原 CDRF-EXT）
源自英文：Command Global Copy File

将文件复制到游戏的任意位置，在此过程中可以另外实现重命名

### 格式
```
CDGCF
[参数1：要复制的文件，从当前位置算起的相对路径]
[参数2：目标文件位置，从游戏目录算起的相对路径]
```
### 注意
此命令设计用于游戏原本没有的文件  
切勿用于游戏本身就有的文件，在卸载时直接删除目标文件，不会去备份中找

---

## CDF（原 CDRF）
源自英文：Command File

将文件复制到游戏的任意位置，在此过程中可以另外实现重命名  
如果要替换游戏本身就有的大文件或者你只是不相让程序去判断是否已安装文件那就用这个
### 格式
```
CDF
[参数1：要复制的文件，从当前位置算起的相对路径]
[参数2：目标文件位置，从游戏目录算起的相对路径]
```

---

## CDVD
我都忘了这个命令为什么这么叫了

覆盖 Content 文件夹

### 格式
```
CDVD
```
就这样，没参数

### 具体使用方法
这是给 XNB MOD 设计的，要替换一堆 XNB 文件的那种  
> 都 TM 2021 年了，还在搞 XNB 替换，真就懒得写 Json  
> 把作者给我揪出来，让我看看是哪个B

在当前文件夹创建一个 Content 文件夹  
然后按照游戏 Content 文件夹的结构放置你要替换的文件

卸载时程序自动按照你的 Content 文件夹的文件布局到备份文件夹里找备份  
如果没找到就会**删除游戏文件！！！**

---
## 条件判断命令
用于判断文件夹和文件是否存在，在一些特殊安装方法中非常实用

与第三代相比，第四代的条件判断命令只是换了个名字，功能完全相同  
这些命令都只有一个参数：从游戏根目录位置算起的文件夹或文件的相对路径

---

#### RQ-D
当指定的文件夹存在时才能继续操作
#### RQ-D-IN
只在安装时生效
#### RQ-D-UN
只在卸载时生效

---

#### RQ-F
当指定的文件存在时才能继续操作
#### RQ-F-IN
只在安装时生效
#### RQ-F-UN
只在卸载时生效

---

## 控制命令
目前只有一个控制命令

### CR-UN-OFF（原 UN-OFF）
声明此项为禁止执行卸载，写在所有命令的最前  
当程序执行到这里时会输出一个错误，后面的命令应该不再运行